# Release notes Mendix Model SDK

## 1.0.0

| story# | impact | description |
|---|---|---|
| 561960 | High | All constructors to create new model elements are removed, instead factory methods should be used. The migration is straight forward: `var entity = new domainmodels.Entity()` becomes: `var entity = domainmodels.Entity.create(model)`. See the next paragraph for more details. |
| 562069 | Medium | Versioning has been added explicitly, so usage of elements and properties is checked against the product (and hence meta model) version. As part of this, `new ModelSdkClient(..)` is no longer valid and has to be replaced with `Model.createSdkClient(..)` everywhere. |
| 569299 | Low | Introduction / deprecation / deletion messages for structures / elements / properties are shown in the typescript documentation. 
| 581572 | Low | Improved error-message when trying to use an unloaded element or property.
| 580561 | Low | An error-message will be returned, when using an out-dated Mendix Model SDK. Only Mendix Model SDK 1.0.0-rc.0 and up are supported now.
| 588942 | Low | Stability improvements when creating new project
| 561960 | Low | It is no longer possible to push `null` or items twice onto a properties that contain a list of elements. |
| 561960 | Low | It is no longer possible to instantiate objects that are derived, such as `LayoutParameter`. |
| 561960 | Low | All model elements expose a `.model` property that returns the model they belong to. |
| 561960 | Low | Convenience methods to create elements and add them to a parent directly are introduced for all elements that are stored at a unique place (this holds for most elements except for utilities like `texts.Text`). See the next paragraph for more details. |
| 553639 | Low | The Model API and SDK observe the same rules for setting properties to `null` as the Business Modeler does: (1) list properties cannot receive `null` at all, (2) non-list properties can only be set to `null` if they are are object-typed (i.e., not primitive or enum) and not required (see documentation). |
| 561972 | Low | It is no longer possible to move a model element from one model to another. In other words: model elements can only exist within the model they were created in. |
| 562069, 561977, 568908 | None | The SDK is now versioned in the sense that structures and properties can have lifecycles, moving from `not yet introduced` to `introduced` to `deprecated` to `deleted` depending on which version of the Mendix Business Modeler was used to create (the MPK for) the working copy. The SDK provides suitable warnings or errors (once per structure/property per connection) on the console whenever a structure or property is used that is either not yet introduced, deprecated or deleted. |
| 463511* | Low | Finding images by qualified name now works, so e.g. `pages.StaticImageViewer.image` isn't always `null`. |
| 585563 | Low | Stability improvements when uploading large files. |
| 583025 | Low | `Structure#traverse` now checks whether the structure has been loaded and fails if not. You have to pre-load traversed structures first if not done already. |
| 585492 | Low | Updated the Model SDK for latest (RC-)version of Business Modeler, i.e. |
| 590510 | None | Extended the Model SDK with file operations. |
| 591741 | None | Improved build process. |
| 564149 | None | The Model SDK now ships with a separate "mini-SDK" that is exclusively used for unit testing the SDK itself. |
| 463511* | None | `IStructure`, `IList`, `IAbstractUnit` and `IEnum` are now (by request) exposed again on top-level. |
| 463511* | None | `Structure` has a new method called `traverse` to (synchronously) traverse this structure and all contained (not referenced) structures - see its TypeDoc for more information. |

('*' means: fixed during this story, but not intrinsically related to this story)

### Introducing structure factories

In this release we moved from argument less constructors to factory methods. This has a few advantages:
1. We can perform more consistency checks upfront, such as whether the type you are creating is available in the Mendix version of your project.
2. Factories can be overloaded in many more ways than constructors, this allows us to introduce even more convenience factories in the future. 

So if you had:
```javascript
function newEntity(domainModel: domainmodels.DomainModel, name: string) {
	var entity = new domainmodels.Entity();
	domainModel.entities.push(entity);
	entity.name = name;
	
	return entity;
}
```

This will become:

```javascript
function newEntity(domainModel: domainmodels.DomainModel, name: string) {
	var entity = domainmodels.Entity.create(domainModel.model); // all factories need to know about the owning model
	domainModel.entities.push(entity);
	entity.name = name;
	
	return entity;
}
```

This seems to make it less convenient to make new structures. However, we introduced convenience factory methods that automatically create new elements _and_ registers them on their parent.
So from this release onward you can just write:

```javascript
function newEntity(domainModel: domainmodels.DomainModel, name: string) {
	var entity = domainmodels.Entity.createIn(domainModel); // pass the domainModel instead of a model
	entity.name = name;
	
	return entity;
}
```

You will notice that this significantly reduces the amount of boilerplate code in application generators.

## 0.8.1

(Previous release: 0.0.1)

The following stories (/features) have been implemented after release 0.0.1 and are part of the 0.8.1 release.
The _impact_ column pertains to how code _using_ the Model SDK could have to be changed due to that story being implemented.
(Order is from high to low impact.)

| story# | impact | description |
|---|---|---|
| 505983 | high | The Model API now checks SDK, API and product versions against each other. The user must upgrade her Mendix project to one of the supported product versions (which are: 5.20, 5.21) in order to be able to work with it, and to upgrade the SDK version to be able to continue working with the API. |
| 552385 | high | The structure of the TypeScript code for the Model SDK has been changed significantly, to be able to make use of the improved module system of TS 1.6. Among other things, the reliance on DefinitelyTyped has been removed: instead, typings are imported through the CommonJS `require` primitive. The user should change the setup to reflect that, notably, all `/// <reference ... ` imports that refer to the sdk need to be removed. The intermediate namespace `sdk` has been removed, the modules `configuration` and `utils` now live at toplevel. The `extras` namespace has been merged into `utils`. The `internal` namespace is no longer exposed, any imports relying on `internal` can now be imported directly from the toplevel.
| 545083 | medium | Working copies always have an expiry date (defaults to 1 day), after which the working copy will be removed from the Model API Server. |
| 561682 | medium | "to serialize" is now consistently written with US spelling, so the user has to change `utils.serialiseToJs` to `utils.serializeToJs`. Also: `Structure.toPlainJson()` now works reflectively, leading to a reduction of the footprint of the SDK code. |
| (no #) | medium | Various refinements have been implemented in the SDK to ensure that models created with it can be opened in the Mendix Business Modeler after export. In some cases, this may cause the user's code to behave slightly different than before - e.g., captions may be generated with two `en_US` translations, one of them empty. |
| 527667 | low | Various refinements have been implemented in the SDK to ensure that required property values cannot be unset by assigning `null` to the property. This is now checked by the SDK before calling the API and triggering an error there, so the user will have early feedback about this and no chance to corrupt models. |
| 551509 | low | The SDK now checks that by-id references can only point to elements/structures in the same unit. |
| 559461 | low | Classes that previously were documented as being abstract/non-instantiable are now really that (using TypeScript 1.6's new `abstract` modifier). |
| 554074 | low | Properties' values can only be written to when the unit is fully-loaded. |
| 553258 | none | Improvements to Model SDK build process. |
| 546717 | none | The default value of properties of type `DateTime` has been changed to `Date.now()` - the only such property is `startDateTime` of `ScheduledEvent` (in the `scheduledevents` namespace). |
| 551534 | none | The TypeScript Docs are now explicitly versioned with the current/latest being the default. |
| 551527 | none | Duplicate but unused SDK code has been removed. |
| 541576 | none | The MIT License has been applied to the SDK. |
| 530354 | none | The to Model SDK-JavaScript code serialiser has been improved in various ways. |
| 530125 | none | Generated documentation has been improved. |
| 554498 | none | Unit tests (for the Model SDK that existed outside that) have been moved into this repository. |
| 552385 | none | Generated documentation has been improved. |
| 560833 | none | Fixed an issue where the chrome debugger might crash while inspecting data. |


## Impact rating

An impact rated as "low" means (for this release) that execution of the user's code may stop prematurely, but that in that case the user could have been generating corrupt or inconsistent models with the previously-released version.

